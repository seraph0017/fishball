!function(t){t.address=function(){var e,r,n,a=function(e){var r=t.extend(t.Event(e),function(){for(var e={},r=t.address.parameterNames(),n=0,a=r.length;n<a;n++)e[r[n]]=t.address.parameter(r[n]);return{value:t.address.value(),path:t.address.path(),pathNames:t.address.pathNames(),parameterNames:r,parameters:e,queryString:t.address.queryString()}}.call(t.address));return t(t.address).trigger(r),r},i=function(t){return Array.prototype.slice.call(t)},s=function(e,r,n){return t().bind.apply(t(t.address),Array.prototype.slice.call(arguments)),t.address},o=function(){return L.pushState&&void 0!==T.state},c=function(){return("/"+F.pathname.replace(new RegExp(T.state),"")+F.search+(d()?"#"+d():"")).replace(W,"/")},d=function(){var t=F.href.indexOf("#");return-1!=t?F.href.substr(t+1):""},u=function(){return o()?c():d()},l=function(t){return t=t.toString(),(T.strict&&"/"!=t.substr(0,1)?"/":"")+t},p=function(t,e){return parseInt(t.css(e),10)},h=function(){if(!K){var t=u();decodeURI(J)!=decodeURI(t)&&(N&&j<7?F.reload():(N&&!z&&T.history&&M(g,50),J=t,f(R)))}},f=function(t){return M(v,10),a(E).isDefaultPrevented()||a(t?S:I).isDefaultPrevented()},v=function(){if("null"!==T.tracker&&T.tracker!==w){var e=t.isFunction(T.tracker)?T.tracker:$[T.tracker],r=(F.pathname+F.search+(t.address&&!o()?t.address.value():"")).replace(/\/\//,"/").replace(/^\/$/,"");t.isFunction(e)?e(r):t.isFunction($.urchinTracker)?$.urchinTracker(r):void 0!==$.pageTracker&&t.isFunction($.pageTracker._trackPageview)?$.pageTracker._trackPageview(r):void 0!==$._gaq&&t.isFunction($._gaq.push)&&$._gaq.push(["_trackPageview",decodeURI(r)])}},g=function(){var t="javascript:"+R+";document.open();document.writeln('<html><head><title>"+O.title.replace(/\'/g,"\\'")+"</title><script>var "+b+' = "'+encodeURIComponent(u()).replace(/\'/g,"\\'")+(O.domain!=F.hostname?'";document.domain="'+O.domain:"")+"\";<\/script></head></html>');document.close();";j<7?e.src=t:e.contentWindow.location.replace(t)},m=function(){if(B&&-1!=P){var t,e,r=B.substr(P+1).split("&");for(t=0;t<r.length;t++)e=r[t].split("="),/^(autoUpdate|history|strict|wrap)$/.test(e[0])&&(T[e[0]]=isNaN(e[1])?/^(true|yes)$/i.test(e[1]):0!==parseInt(e[1],10)),/^(state|tracker)$/.test(e[0])&&(T[e[0]]=e[1]);B=w}J=u()},y=function(){if(!Q){if(Q=U,m(),t('a[rel*="address:"]').address(),T.wrap){var r=t("body");t("body > *").wrapAll('<div style="padding:'+(p(r,"marginTop")+p(r,"paddingTop"))+"px "+(p(r,"marginRight")+p(r,"paddingRight"))+"px "+(p(r,"marginBottom")+p(r,"paddingBottom"))+"px "+(p(r,"marginLeft")+p(r,"paddingLeft"))+'px;" />').parent().wrap('<div id="'+b+'" style="height:100%;overflow:auto;position:relative;'+(q&&!window.statusbar.visible?"resize:both;":"")+'" />');t("html, body").css({height:"100%",margin:0,padding:0,overflow:"hidden"}),q&&t('<style type="text/css" />').appendTo("head").text("#"+b+"::-webkit-resizer { background-color: #fff; }")}if(N&&!z){var n=O.getElementsByTagName("frameset")[0];(e=O.createElement((n?"":"i")+"frame")).src="javascript:"+R,n?(n.insertAdjacentElement("beforeEnd",e),n[n.cols?"cols":"rows"]+=",0",e.noResize=U,e.frameBorder=e.frameSpacing=0):(e.style.display="none",e.style.width=e.style.height=0,e.tabIndex=-1,O.body.insertAdjacentElement("afterBegin",e)),M(function(){t(e).bind("load",function(){var t=e.contentWindow;(J=void 0!==t[b]?t[b]:"")!=u()&&(f(R),F.hash=J)}),void 0===e.contentWindow[b]&&g()},50)}M(function(){a("init"),f(R)},1),o()||(N&&j>7||!N&&z?$.addEventListener?$.addEventListener(x,h,R):$.attachEvent&&$.attachEvent("on"+x,h):C(h,50)),"state"in window.history&&t(window).trigger("popstate")}},w=null,b="jQueryAddress",x="hashchange",k="init",E="change",S="internalChange",I="externalChange",U=!0,R=!1,T={autoUpdate:U,history:U,strict:U,wrap:R},A=(r={},(n=function(t){t=t.toLowerCase();var e=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:e[1]||"",version:e[2]||"0"}}(navigator.userAgent)).browser&&(r[n.browser]=!0,r.version=n.version),r.chrome?r.webkit=!0:r.webkit&&(r.safari=!0),r),j=parseFloat(A.version),q=A.webkit||A.safari,N=!t.support.opacity,$=function(){try{return void 0!==top.document&&void 0!==top.document.title?top:window}catch(t){return window}}(),O=$.document,L=$.history,F=$.location,C=setInterval,M=setTimeout,W=/\/{2,9}/g,_=navigator.userAgent,z="on"+x in $,B=t("script:last").attr("src"),P=B?B.indexOf("?"):-1,D=O.title,K=R,Q=R,G=U,H=R,J=u();if(N){j=parseFloat(_.substr(_.indexOf("MSIE")+4)),O.documentMode&&O.documentMode!=j&&(j=8!=O.documentMode?7:8);var V=O.onpropertychange;O.onpropertychange=function(){V&&V.call(O),O.title!=D&&-1!=O.title.indexOf("#"+u())&&(O.title=D)}}if(L.navigationMode&&(L.navigationMode="compatible"),"complete"==document.readyState)var X=setInterval(function(){t.address&&(y(),clearInterval(X))},50);else m(),t(y);return t(window).bind("popstate",function(){decodeURI(J)!=decodeURI(u())&&(J=u(),f(R))}).bind("unload",function(){$.removeEventListener?$.removeEventListener(x,h,R):$.detachEvent&&$.detachEvent("on"+x,h)}),{bind:function(t,e,r){return s.apply(this,i(arguments))},unbind:function(e,r){return function(e,r){return t().unbind.apply(t(t.address),Array.prototype.slice.call(arguments)),t.address}.apply(this,i(arguments))},init:function(t,e){return s.apply(this,[k].concat(i(arguments)))},change:function(t,e){return s.apply(this,[E].concat(i(arguments)))},internalChange:function(t,e){return s.apply(this,[S].concat(i(arguments)))},externalChange:function(t,e){return s.apply(this,[I].concat(i(arguments)))},baseURL:function(){var t=F.href;return-1!=t.indexOf("#")&&(t=t.substr(0,t.indexOf("#"))),/\/$/.test(t)&&(t=t.substr(0,t.length-1)),t},autoUpdate:function(t){return void 0!==t?(T.autoUpdate=t,this):T.autoUpdate},history:function(t){return void 0!==t?(T.history=t,this):T.history},state:function(t){if(void 0!==t){T.state=t;var e=c();return void 0!==T.state&&(L.pushState?"/#/"==e.substr(0,3)&&F.replace(T.state.replace(/^\/$/,"")+e.substr(2)):"/"!=e&&e.replace(/^\/#/,"")!=d()&&M(function(){F.replace(T.state.replace(/^\/$/,"")+"/#"+e)},1)),this}return T.state},strict:function(t){return void 0!==t?(T.strict=t,this):T.strict},tracker:function(t){return void 0!==t?(T.tracker=t,this):T.tracker},wrap:function(t){return void 0!==t?(T.wrap=t,this):T.wrap},update:function(){return H=U,this.value(J),H=R,this},title:function(t){return void 0!==t?(M(function(){D=O.title=t,G&&e&&e.contentWindow&&e.contentWindow.document&&(e.contentWindow.document.title=t,G=R)},50),this):O.title},value:function(t){if(void 0!==t){if("/"==(t=l(t))&&(t=""),J==t&&!H)return;if(J=t,T.autoUpdate||H){if(f(U))return this;o()?L[T.history?"pushState":"replaceState"]({},"",T.state.replace(/\/$/,"")+(""===J?"/":J)):(K=U,q?T.history?F.hash="#"+J:F.replace("#"+J):J!=u()&&(T.history?F.hash="#"+J:F.replace("#"+J)),N&&!z&&T.history&&M(g,50),q?M(function(){K=R},1):K=R)}return this}return l(J)},path:function(t){if(void 0!==t){var e=this.queryString(),r=this.hash();return this.value(t+(e?"?"+e:"")+(r?"#"+r:"")),this}return l(J).split("#")[0].split("?")[0]},pathNames:function(){var t=this.path(),e=t.replace(W,"/").split("/");return"/"!=t.substr(0,1)&&0!==t.length||e.splice(0,1),"/"==t.substr(t.length-1,1)&&e.splice(e.length-1,1),e},queryString:function(t){if(void 0!==t){var e=this.hash();return this.value(this.path()+(t?"?"+t:"")+(e?"#"+e:"")),this}var r=J.split("?");return r.slice(1,r.length).join("?").split("#")[0]},parameter:function(e,r,n){var a,i;if(void 0!==r){var s=this.parameterNames();for(i=[],r=void 0===r||r===w?"":r.toString(),a=0;a<s.length;a++){var o=s[a],c=this.parameter(o);"string"==typeof c&&(c=[c]),o==e&&(c=r===w||""===r?[]:n?c.concat([r]):[r]);for(var d=0;d<c.length;d++)i.push(o+"="+c[d])}return-1==t.inArray(e,s)&&r!==w&&""!==r&&i.push(e+"="+r),this.queryString(i.join("&")),this}if(r=this.queryString()){var u=[];for(i=r.split("&"),a=0;a<i.length;a++){var l=i[a].split("=");l[0]==e&&u.push(l.slice(1).join("="))}if(0!==u.length)return 1!=u.length?u:u[0]}},parameterNames:function(){var e=this.queryString(),r=[];if(e&&-1!=e.indexOf("="))for(var n=e.split("&"),a=0;a<n.length;a++){var i=n[a].split("=")[0];-1==t.inArray(i,r)&&r.push(i)}return r},hash:function(t){if(void 0!==t)return this.value(J.split("#")[0]+(t?"#"+t:"")),this;var e=J.split("#");return e.slice(1,e.length).join("#")}}}(),t.fn.address=function(e){return this.data("address")||this.on("click",function(r){if(r.shiftKey||r.ctrlKey||r.metaKey||2==r.which)return!0;var n=r.currentTarget;if(t(n).is("a")){r.preventDefault();var a=e?e.call(n):/address:/.test(t(n).attr("rel"))?t(n).attr("rel").split("address:")[1].split(" ")[0]:void 0===t.address.state()||/^\/?$/.test(t.address.state())?t(n).attr("href").replace(/^(#\!?|\.)/,""):t(n).attr("href").replace(new RegExp("^(.*"+t.address.state()+"|\\.)"),"");t.address.value(a)}}).on("submit",function(r){var n=r.currentTarget;if(t(n).is("form")){r.preventDefault();var a=t(n).attr("action"),i=e?e.call(n):(-1!=a.indexOf("?")?a.replace(/&$/,""):a+"?")+t(n).serialize();t.address.value(i)}}).data("address",!0),this}}(jQuery);